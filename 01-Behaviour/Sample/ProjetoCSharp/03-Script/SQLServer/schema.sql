DROP TABLE GP_DLLParametros 
GO
DROP TABLE GP_DLL 
GO
DROP TABLE GP_AGENDAMENTO 
GO
DROP TABLE GP_EMAIL 
GO
DROP TABLE GP_PERIODICIDADE 
GO
DROP TABLE GP_EXCEPTIONS
GO
DROP TABLE GP_ROTINA 
GO

CREATE TABLE GP_ROTINA 
(
	idRotina INTEGER IDENTITY NOT NULL,
	Nome VARCHAR(50) NOT NULL,
	Decricao VARCHAR(255) NOT NULL,
	DataCriacao DATETIME NOT NULL,
	Usuario VARCHAR(20) NULL,
	Funcional VARCHAR(20) NULL,
	Ativo BIT NOT NULL,
	Apelido VARCHAR(50) NULL,
	PRIMARY KEY(idRotina)
)
GO

CREATE TABLE GP_EXCEPTIONS 
(
	idExceptions INTEGER IDENTITY NOT NULL,
	idRotina INTEGER NULL,
	Tentativa INTEGER NOT NULL,
	Intervalo INTEGER NOT NULL,
	EnviarEmail BIT NOT NULL,
	EnviarUltimoEmail BIT NOT NULL,
	PRIMARY KEY(idExceptions),
	FOREIGN KEY(idRotina)
		REFERENCES GP_ROTINA(idRotina)
)
GO

CREATE TABLE GP_PERIODICIDADE 
(
	idPeriodicidade INTEGER IDENTITY NOT NULL,
	idRotina INTEGER NULL,
	Tipo INTEGER NOT NULL,
	Parametro VARCHAR(100) NOT NULL,
	PRIMARY KEY(idPeriodicidade),
	FOREIGN KEY(idRotina)
		REFERENCES GP_ROTINA(idRotina)
)
GO

CREATE TABLE GP_EMAIL 
(
	idEMAIL INTEGER IDENTITY NOT NULL,
	idRotina INTEGER NULL,
	[FROM] VARCHAR(8000) NULL,
	[TO] VARCHAR(8000) NULL,
	[SUBJECT] VARCHAR(500) NULL,
	[TYPE] VARCHAR(5) NULL,
	[BODY] VARCHAR(8000) NULL,
	Classificacao INTEGER NULL,
	Anexo VARCHAR(8000) NOT NULL,
	Ativo BIT NULL,
	PRIMARY KEY(idEMAIL),
	FOREIGN KEY(idRotina)
		REFERENCES GP_ROTINA(idRotina)
)
GO

CREATE TABLE GP_AGENDAMENTO 
(
	idAgendamento INTEGER IDENTITY NOT NULL,
	idRotina INTEGER NULL,
	DataInicio DATETIME NOT NULL,
	HoraInicio CHAR(8) NOT NULL,
	DataFim DATETIME NULL,
	HoraFim CHAR(8) NULL,
	Intervalo INTEGER NOT NULL,
	Repeticao INTEGER NOT NULL,
	PRIMARY KEY(idAgendamento),
	FOREIGN KEY(idRotina)
		REFERENCES GP_ROTINA(idRotina)
)
GO

CREATE TABLE GP_DLL 
(
	idDLL INTEGER IDENTITY NOT NULL,
	idRotina INTEGER NULL,
	Ordem INTEGER NOT NULL,
	Nome VARCHAR(100) NULL,
	Assembly VARCHAR(100) NOT NULL,
	Dependencia INTEGER NOT NULL,
	PRIMARY KEY(idDLL),
	FOREIGN KEY(idRotina)
		REFERENCES GP_ROTINA(idRotina)
)
GO

CREATE TABLE GP_DLLParametros 
(
  idDLLParametros INTEGER IDENTITY NOT NULL,
  idDLL INTEGER NULL,
  Nome VARCHAR(50) NOT NULL,
  Valor VARCHAR(8000) NOT NULL,
  Tipo INTEGER NOT NULL,
  Formato VARCHAR(2) NOT NULL,
  PRIMARY KEY(idDLLParametros),
  CONSTRAINTS FOREIGN KEY(idDLL)
    REFERENCES GP_DLL(idDLL)
)
GO
