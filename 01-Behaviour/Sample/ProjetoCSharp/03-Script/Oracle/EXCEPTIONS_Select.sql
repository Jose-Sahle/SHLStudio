/**********************************************************
  AUTHOR	: 
  VERSION	: 1.0.0.0
  DATE		: 08/04/2014 09:03:44
  FUNCTION	: Select records from table GP_EXCEPTIONS filtered by 
		  parameters passed into the procedure
**********************************************************/
/*Create the SQL for the stored procedure*/
CREATE OR REPLACE PROCEDURE EXCEPTIONS_Select
(
    var_IDEXCEPTIONS IN INTEGER  DEFAULT NULL,
    var_IDROTINA IN INTEGER  DEFAULT NULL,
    var_TENTATIVA IN INTEGER  DEFAULT NULL,
    var_INTERVALO IN INTEGER  DEFAULT NULL,
    var_ENVIAREMAIL IN INTEGER  DEFAULT NULL,
    var_ENVIARULTIMOEMAIL IN INTEGER  DEFAULT NULL
    ,returnset    OUT SYS_REFCURSOR
) 
IS
BEGIN
	OPEN returnset FOR
		SELECT
			IDEXCEPTIONS,
			IDROTINA,
			TENTATIVA,
			INTERVALO,
			ENVIAREMAIL,
			ENVIARULTIMOEMAIL
		FROM
			GP_EXCEPTIONS
		WHERE
			(IDEXCEPTIONS = var_IDEXCEPTIONS or var_IDEXCEPTIONS is null)
		AND (IDROTINA = var_IDROTINA OR var_IDROTINA IS NULL)
		AND (TENTATIVA = var_TENTATIVA OR var_TENTATIVA IS NULL)
		AND (INTERVALO = var_INTERVALO OR var_INTERVALO IS NULL)
		AND (ENVIAREMAIL = var_ENVIAREMAIL OR var_ENVIAREMAIL IS NULL)
		AND (ENVIARULTIMOEMAIL = var_ENVIARULTIMOEMAIL OR var_ENVIARULTIMOEMAIL IS NULL)
		;
END EXCEPTIONS_Select;
GO

