/**********************************************************
  AUTHOR	: 
  VERSION	: 1.0.0.0
  DATE		: 08/04/2014 09:03:44
  FUNCTION	: Select records from table GP_EMAIL filtered by 
		  parameters passed into the procedure
**********************************************************/
/*Create the SQL for the stored procedure*/
CREATE OR REPLACE PROCEDURE EMAIL_Select
(
    var_IDEMAIL IN INTEGER  DEFAULT NULL,
    var_IDROTINA IN INTEGER  DEFAULT NULL,
    var_FROMEMAIL IN VARCHAR2  DEFAULT NULL,
    var_TOEMAIL IN VARCHAR2  DEFAULT NULL,
    var_SUBJECTEMAIL IN VARCHAR2  DEFAULT NULL,
    var_TYPEEMAIL IN VARCHAR2  DEFAULT NULL,
    var_BODYEMAIL IN VARCHAR2  DEFAULT NULL,
    var_CLASSIFICACAO IN INTEGER  DEFAULT NULL,
    var_ANEXO IN VARCHAR2  DEFAULT NULL,
    var_ATIVO IN INTEGER  DEFAULT NULL
    ,returnset    OUT SYS_REFCURSOR
) 
IS
BEGIN
	OPEN returnset FOR
		SELECT
			IDEMAIL,
			IDROTINA,
			FROMEMAIL,
			TOEMAIL,
			SUBJECTEMAIL,
			TYPEEMAIL,
			BODYEMAIL,
			CLASSIFICACAO,
			ANEXO,
			ATIVO
		FROM
			GP_EMAIL
		WHERE
			(IDEMAIL = var_IDEMAIL or var_IDEMAIL is null)
		AND (IDROTINA = var_IDROTINA OR var_IDROTINA IS NULL)
		AND (FROMEMAIL = var_FROMEMAIL OR var_FROMEMAIL IS NULL)
		AND (TOEMAIL = var_TOEMAIL OR var_TOEMAIL IS NULL)
		AND (SUBJECTEMAIL = var_SUBJECTEMAIL OR var_SUBJECTEMAIL IS NULL)
		AND (TYPEEMAIL = var_TYPEEMAIL OR var_TYPEEMAIL IS NULL)
		AND (BODYEMAIL = var_BODYEMAIL OR var_BODYEMAIL IS NULL)
		AND (CLASSIFICACAO = var_CLASSIFICACAO OR var_CLASSIFICACAO IS NULL)
		AND (ANEXO = var_ANEXO OR var_ANEXO IS NULL)
		AND (ATIVO = var_ATIVO OR var_ATIVO IS NULL)
		;
END EMAIL_Select;
GO

