DROP TABLE IF EXISTS GP_DLLPARAMETROS ;
DROP TABLE IF EXISTS GP_DLL;
DROP TABLE IF EXISTS GP_AGENDAMENTO ;
DROP TABLE IF EXISTS GP_EMAIL ;
DROP TABLE IF EXISTS GP_PERIODICIDADE ;
DROP TABLE IF EXISTS GP_EXCEPTIONS ;
DROP TABLE IF EXISTS GP_ROTINA ;
GO

CREATE TABLE IF NOT EXISTS GP_ROTINA 
(
	idRotina INT(10) NOT NULL AUTO_INCREMENT,
	Nome VARCHAR(50) NOT NULL,
	Decricao VARCHAR(255) NOT NULL,
	DataCriacao DATETIME NOT NULL,
	Usuario VARCHAR(20) NULL,
	Funcional VARCHAR(20) NULL,
	Ativo BIT NOT NULL,
	Apelido VARCHAR(50) NULL,
	PRIMARY KEY(idRotina)
)
ENGINE = INNODB;
GO

CREATE TABLE IF NOT EXISTS GP_EXCEPTIONS 
(
	idExceptions INT(10)  NOT NULL AUTO_INCREMENT,
	idRotina INT(10)  NULL,
	Tentativa INTEGER NOT NULL,
	Intervalo INTEGER NOT NULL,
	EnviarEmail BIT NOT NULL,
	EnviarUltimoEmail BIT NOT NULL,
	PRIMARY KEY(idExceptions),
	CONSTRAINT gp_exceptions_rotina_fk FOREIGN KEY gp_exceptions_rotina_fk(idRotina)
		REFERENCES GP_ROTINA(idRotina)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
)
ENGINE = INNODB;
GO

CREATE TABLE IF NOT EXISTS GP_PERIODICIDADE 
(
	idPeriodicidade INT(10)  NOT NULL AUTO_INCREMENT,
	idRotina INT(10)  NULL,
	Tipo INTEGER NOT NULL,
	Parametro VARCHAR(100) NOT NULL,
	PRIMARY KEY(idPeriodicidade),
	CONSTRAINT gp_periodicidade_rotina_fk FOREIGN KEY gp_periodicidade_rotina_fk (idRotina)
		REFERENCES GP_ROTINA(idRotina)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
)
ENGINE = INNODB;
GO

CREATE TABLE IF NOT EXISTS GP_EMAIL 
(
	idEMAIL INT(10) NOT NULL AUTO_INCREMENT,
	idRotina INT(10) NULL,
	`FROM` VARCHAR(8000) NULL,
	`TO` VARCHAR(8000) NULL,
	`SUBJECT` VARCHAR(500) NULL,
	`TYPE` VARCHAR(5) NULL,
	`BODY` VARCHAR(8000) NULL,
	Classificacao INTEGER NULL,
	Anexo VARCHAR(8000) NOT NULL,
	Ativo BIT NULL,
	PRIMARY KEY(idEMAIL),
	CONSTRAINT gp_email_rotina_fk FOREIGN KEY gp_email_rotina_fk(idRotina)
		REFERENCES GP_ROTINA(idRotina)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
)
ENGINE = INNODB;
GO

CREATE TABLE IF NOT EXISTS GP_AGENDAMENTO 
(
	idAgendamento INT(10) NOT NULL AUTO_INCREMENT,
	idRotina INT(10) NULL,
	DataInicio DATETIME NOT NULL,
	HoraInicio CHAR(8) NOT NULL,
	DataFim DATETIME NULL,
	HoraFim CHAR(8) NULL,
	Intervalo INTEGER NOT NULL,
	Repeticao INTEGER NOT NULL,
	PRIMARY KEY(idAgendamento),
	CONSTRAINT gp_agendamento_rotina_fk FOREIGN KEY gp_agendamento_rotina_fk(idRotina)
		REFERENCES GP_ROTINA(idRotina)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
);
GO

CREATE TABLE IF NOT EXISTS GP_DLL 
(
	idDLL INT(10) NOT NULL AUTO_INCREMENT,
	idRotina INT(10) NULL,
	Ordem INTEGER NOT NULL,
	Nome VARCHAR(100) NULL,
	Assembly VARCHAR(100) NOT NULL,
	Dependencia INTEGER NOT NULL,
	PRIMARY KEY(idDLL),
	CONSTRAINT gp_dll_rotina_fk FOREIGN KEY gp_dll_rotina_fk(idRotina)
		REFERENCES GP_ROTINA(idRotina)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
);
GO

CREATE TABLE IF NOT EXISTS GP_DLLPARAMETROS 
(
	idDLLParametros INT(10) NOT NULL AUTO_INCREMENT,
	idDLL INT(10) NULL,
	Nome VARCHAR(50) NOT NULL,
	Valor VARCHAR(8000) NOT NULL,
	Tipo INTEGER NOT NULL,
	Formato VARCHAR(2) NOT NULL,
	PRIMARY KEY(idDLLParametros),
	CONSTRAINT gp_dllparametros_dll_fk FOREIGN KEY gp_dllparametros_dll_fk(idDLL)
		REFERENCES GP_DLL(idDLL)
			ON DELETE NO ACTION
			ON UPDATE NO ACTION
);
GO
